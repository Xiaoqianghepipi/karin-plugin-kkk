import { getBilibiliData, getDouyinData } from '@ikenxuan/amagi';
import karin from 'node-karin';
import { Config } from '../module/index.js';
import { Bilibilipush, DouYinpush } from '../platform/index.js';
export const douyinPush = Config.douyin.push.switch && karin.task('ÊäñÈü≥Êé®ÈÄÅ', Config.douyin.push.cron, async () => {
    await new DouYinpush().action();
    return true;
}, { name: 'kkk-Êé®ÈÄÅÂäüËÉΩ-ÊäñÈü≥', notAdapter: ['QQBot'], log: Config.douyin.push.log });
export const bilibiliPush = Config.bilibili.push.switch && karin.task('BÁ´ôÊé®ÈÄÅ', Config.bilibili.push.cron, async () => {
    await new Bilibilipush().action();
    return true;
}, { name: 'kkk-Êé®ÈÄÅÂäüËÉΩ-BÁ´ô', notAdapter: ['QQBot'], log: Config.bilibili.push.log });
export const forcePush = karin.command(new RegExp(/#(ÊäñÈü≥|BÁ´ô)(ÂÖ®ÈÉ®)?Âº∫Âà∂Êé®ÈÄÅ/), async (e) => {
    if (e.msg.includes('ÊäñÈü≥')) {
        await new DouYinpush(e, true).action();
        return true;
    }
    else if (e.msg.includes('BÁ´ô')) {
        await new Bilibilipush(e, true).action();
        return true;
    }
    return true;
}, { name: 'ùë™ùíäùíÇùíçùíçùíêÔΩû(‚à†„Éªœâ< )‚åí‚òÖ', permission: 'master' });
export const setdyPush = Config.bilibili.push.switch && karin.command(new RegExp(/^#ËÆæÁΩÆÊäñÈü≥Êé®ÈÄÅ/), async (e) => {
    const data = await getDouyinData('ÊêúÁ¥¢Êï∞ÊçÆ', Config.cookies.douyin, { query: e.msg.replace(/^#ËÆæÁΩÆÊäñÈü≥Êé®ÈÄÅ/, '') });
    await e.reply(await new DouYinpush(e).setting(data));
    return true;
}, { name: 'kkk-Êé®ÈÄÅÂäüËÉΩ-ËÆæÁΩÆ', event: 'message.group_message' });
export const setbiliPush = Config.bilibili.push.switch && karin.command(new RegExp(/^#ËÆæÁΩÆ[bB]Á´ôÊé®ÈÄÅ(?:[Uu][Ii][Dd]:)?(\d+)$/), async (e) => {
    const match = /^#ËÆæÁΩÆ[bB]Á´ôÊé®ÈÄÅ(?:UID:)?(\d+)$/.exec(e.msg);
    if (match && match[1]) {
        const data = await getBilibiliData('Áî®Êà∑‰∏ªÈ°µÊï∞ÊçÆ', Config.cookies.bilibili, { host_mid: match[1] });
        await e.reply(await new Bilibilipush(e).setting(data));
    }
    return true;
}, { name: 'kkk-Êé®ÈÄÅÂäüËÉΩ-ËÆæÁΩÆ', event: 'message.group_message', permission: Config.bilibili.push.permission });
export const changeBotID = karin.command(new RegExp(/^#kkkËÆæÁΩÆÊé®ÈÄÅÊú∫Âô®‰∫∫/), async (e) => {
    const newDouyinlist = Config.pushlist.douyin.map(item => {
        // Êìç‰ΩúÊØè‰∏™ group_id
        const modifiedGroupIds = item.group_id.map(groupId => {
            const [group_id, uin] = groupId.split(':');
            return `${group_id}:${e.msg.replace(/^#kkkËÆæÁΩÆÊé®ÈÄÅÊú∫Âô®‰∫∫/, '')}`;
        });
        return {
            ...item,
            group_id: modifiedGroupIds
        };
    });
    const newBilibililist = Config.pushlist.bilibili.map(item => {
        // Êìç‰ΩúÊØè‰∏™ group_id
        const modifiedGroupIds = item.group_id.map(groupId => {
            const [group_id, uin] = groupId.split(':');
            return `${group_id}:${e.msg.replace(/^#kkkËÆæÁΩÆÊé®ÈÄÅÊú∫Âô®‰∫∫/, '')}`;
        });
        return {
            ...item,
            group_id: modifiedGroupIds
        };
    });
    Config.modify('pushlist', 'douyin', newDouyinlist);
    Config.modify('pushlist', 'bilibili', newBilibililist);
    await e.reply('Êé®ÈÄÅÊú∫Âô®‰∫∫Â∑≤‰øÆÊîπ‰∏∫' + e.msg.replace(/^#kkkËÆæÁΩÆÊé®ÈÄÅÊú∫Âô®‰∫∫/, ''));
    return true;
}, { name: 'kkk-Êé®ÈÄÅÂäüËÉΩ-ËÆæÁΩÆ', permission: 'master' });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHVzaC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcHBzL3B1c2gudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGVBQWUsRUFBRSxhQUFhLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQTtBQUVoRSxPQUFPLEtBQUssTUFBTSxZQUFZLENBQUE7QUFFOUIsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLFVBQVUsQ0FBQTtBQUNqQyxPQUFPLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBRSxNQUFNLFlBQVksQ0FBQTtBQUVyRCxNQUFNLENBQUMsTUFBTSxVQUFVLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxLQUFLLElBQUksRUFBRTtJQUM1RyxNQUFNLElBQUksVUFBVSxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUE7SUFDL0IsT0FBTyxJQUFJLENBQUE7QUFDYixDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsYUFBYSxFQUFFLFVBQVUsRUFBRSxDQUFFLE9BQU8sQ0FBRSxFQUFFLEdBQUcsRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFBO0FBRWpGLE1BQU0sQ0FBQyxNQUFNLFlBQVksR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEtBQUssSUFBSSxFQUFFO0lBQ2xILE1BQU0sSUFBSSxZQUFZLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQTtJQUNqQyxPQUFPLElBQUksQ0FBQTtBQUNiLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxhQUFhLEVBQUUsVUFB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